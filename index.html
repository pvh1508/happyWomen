<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.3.0/css/all.min.css" integrity="sha512-SzlrxWUlpfuzQ+pcUCosxcglQRNAq/DZjVsC0lE40xsADsfeQoEypE+enwcOiGjk/bSuGGKHEyjSoQ1zVisanQ==" crossorigin="anonymous" referrerpolicy="no-referrer"
    />
    <link rel="icon" href="https://scontent.fsgn2-7.fna.fbcdn.net/v/t39.30808-6/275854716_1009516859998712_3360791562563963516_n.jpg?_nc_cat=100&ccb=1-7&_nc_sid=174925&_nc_ohc=Nd-x8LBVkfEAX-8j_3d&_nc_ht=scontent.fsgn2-7.fna&oh=00_AfCE12FbrIzhS4MFFIpLnp91XXbAS27AcV3yTsAqHtNIHw&oe=640ADB19"
    />
    <link rel="stylesheet" href="style.css" />
    <title>APEC - Chúc mừng ngày 8 -3</title>
</head>

<style>
    #snowflakeContainer {
        position: absolute;
        left: 0px;
        top: 0px;
    }
    
    .snowflake {
        padding-left: 15px;
        font-size: 14px;
        line-height: 24px;
        position: fixed;
        color: #fd6e6e;
        user-select: none;
        z-index: 1000;
        -moz-user-select: none;
        -ms-user-select: none;
        -khtml-user-select: none;
        -webkit-user-select: none;
        -webkit-touch-callout: none;
    }
    
    .snowflake:hover {
        cursor: default;
    }
</style>

<body>

    <audio id="myAudio" preload="none" autoplay>
      <source src="fileAudio.mp3" type="audio/mpeg">
    </audio>


    <div class="back-button" onclick="goBack()">Quay lại</div>

    <div class="typewriter">
        <h1>Happy Women's Day 8/3</h1>
    </div>

    <div class="typewriter-content">
        <h2>Ngày hôm nay là 1 ngày tuyệt vời, chúng tôi những người đàn ông đại diện cho phái mạnh APEC TECH nói riêng và APEC GROUP nói chung xin được gửi đến những lời chúc tốt đẹp dành tặng đến những cô gái xinh đẹp nhất. Hãy tìm đến hòm thư của riêng
            mình để nhận lấy tấm lòng của anh em chúng tôi nhé!</h3>
    </div>

    <div class="box-audio" onclick="playAudio()">Hãy bắt đầu với một chút âm nhạc nhé ➡️ 🎁</div>

    <div class="wrapper">
        <div class="box-header">
            <div class="imagecontent">
                <img />
            </div>
        </div>
        <button></button>
        <div class="content">
            <i class="fa-solid fa-xmark"></i>
            <h1>💞💗💞 Gửi! 💗</h1>
            <p>
                Ngày 8/3, chúc một nửa thế giới luôn thành công trong cuộc sống! Chúc bạn luôn duyên dáng và xinh đẹp trong mắt một nửa thế giới còn lại!
            </p>
            <div class="loader">
                <div class="cardHover">
                    <div class="inner one" style="--i: 1"></div>
                    <div class="inner two" style="--i: 1"></div>
                    <div class="inner three" style="--i: 1"></div>
                    <div class="box-heart">
                        <div class="heart"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="departments-container" id="departmentsContainer"></div>

    <div class="employees-container" id="employeesContainer"></div>

    <div id="snowflakeContainer">
        <p class="snowflake">❀✿</p>
    </div>


</body>
<script type="text/javascript" src="vanilla-tilt.js"></script>
<!-- <script type="text/javascript" src="users.js"></script> -->
<script>
    //<![CDATA[
    var requestAnimationFrame =
        window.requestAnimationFrame ||
        window.mozRequestAnimationFrame ||
        window.webkitRequestAnimationFrame ||
        window.msRequestAnimationFrame;
    var transforms = [
        "transform",
        "msTransform",
        "webkitTransform",
        "mozTransform",
        "oTransform",
    ];
    var transformProperty = getSupportedPropertyName(transforms);
    var snowflakes = [];
    var browserWidth;
    var browserHeight;
    var numberOfSnowflakes = 50;
    var resetPosition = false;

    function setup() {
        window.addEventListener("DOMContentLoaded", generateSnowflakes, false);
        window.addEventListener("resize", setResetFlag, false);
    }
    setup();

    function getSupportedPropertyName(b) {
        for (var a = 0; a < b.length; a++) {
            if (typeof document.body.style[b[a]] != "undefined") {
                return b[a];
            }
        }
        return null;
    }

    function Snowflake(b, a, d, e, c) {
        this.element = b;
        this.radius = a;
        this.speed = d;
        this.xPos = e;
        this.yPos = c;
        this.counter = 0;
        this.sign = Math.random() < 0.5 ? 1 : -1;
        this.element.style.opacity = 0.5 + Math.random();
        this.element.style.fontSize = 4 + Math.random() * 30 + "px";
    }
    Snowflake.prototype.update = function() {
        this.counter += this.speed / 5000;
        this.xPos += (this.sign * this.speed * Math.cos(this.counter)) / 40;
        this.yPos += Math.sin(this.counter) / 40 + this.speed / 30;
        setTranslate3DTransform(
            this.element,
            Math.round(this.xPos),
            Math.round(this.yPos)
        );
        if (this.yPos > browserHeight) {
            this.yPos = -50;
        }
    };

    function setTranslate3DTransform(a, c, b) {
        var d = "translate3d(" + c + "px, " + b + "px, 0)";
        a.style[transformProperty] = d;
    }

    function generateSnowflakes() {
        var b = document.querySelector(".snowflake");
        var h = b.parentNode;
        browserWidth = document.documentElement.clientWidth;
        browserHeight = document.documentElement.clientHeight;
        for (var d = 0; d < numberOfSnowflakes; d++) {
            var j = b.cloneNode(true);
            h.appendChild(j);
            var e = getPosition(50, browserWidth);
            var a = getPosition(50, browserHeight);
            var c = 5 + Math.random() * 40;
            var g = 4 + Math.random() * 10;
            var f = new Snowflake(j, g, c, e, a);
            snowflakes.push(f);
        }
        h.removeChild(b);
        moveSnowflakes();
    }

    function moveSnowflakes() {
        for (var b = 0; b < snowflakes.length; b++) {
            var a = snowflakes[b];
            a.update();
        }
        if (resetPosition) {
            browserWidth = document.documentElement.clientWidth;
            browserHeight = document.documentElement.clientHeight;
            for (var b = 0; b < snowflakes.length; b++) {
                var a = snowflakes[b];
                a.xPos = getPosition(50, browserWidth);
                a.yPos = getPosition(50, browserHeight);
            }
            resetPosition = false;
        }
        requestAnimationFrame(moveSnowflakes);
    }

    function getPosition(b, a) {
        return Math.round(-1 * b + Math.random() * (a + 2 * b));
    }

    function setResetFlag(a) {
        resetPosition = true;
    }
    //]]>
</script>
<script>
    VanillaTilt.init(document.querySelector(".wrapper"), {
        max: 25,
        speed: 400,
        glare: true,
        "max-glare": 0.25,
        gyroscopeMinAngleX: -45,
    });
    var btn = document.querySelector("button");
    var closeBtn = document.querySelector(".fa-xmark");
    var closeBack = document.querySelector(".back-button");

    btn.addEventListener("click", () => {
        document.querySelector(".wrapper").classList.add("active");
        btn.style.display = "none";
    });
    closeBtn.addEventListener("click", () => {
        document.querySelector(".wrapper").classList.remove("active");
        btn.style.display = "block";
    });
    closeBack.addEventListener("click", () => {
        document.querySelector(".wrapper").classList.remove("active");
        btn.style.display = "block";
    });
</script>

<script>
    function fetchDepartments() {
        fetch(
                "https://api-gateway-test.apecgroup.net/api/cm/apec-event/department"
            )
            .then((response) => response.json())
            .then((res) => {
                displayDepartments(res.data);
            })
            .catch((error) => console.error("Error fetching departments:", error));
    }

    function displayDepartments(departments) {
        const departmentsContainer = document.getElementById(
            "departmentsContainer"
        );

        // Xóa các phòng ban cũ trước khi thêm mới
        departmentsContainer.innerHTML = "";

        // Duyệt qua danh sách phòng ban và thêm chúng vào HTML
        departments.forEach((department) => {
            const departmentCard = document.createElement("div");
            departmentCard.className = "department-card";

            const departmentName = document.createElement("div");
            departmentName.className = "department-name";
            departmentName.textContent = department.name;

            // Gắn sự kiện click để hiển thị nhân viên của phòng ban
            departmentName.onclick = function() {
                showEmployees(department.name);
            };

            departmentCard.appendChild(departmentName);
            departmentsContainer.appendChild(departmentCard);
        });
    }

    function showUser(name) {
        document.querySelector(".wrapper").classList.add("active");
    }

    function showEmployees(departmentName) {
        // Ẩn tất cả các containers phòng ban
        var departmentCards = document.querySelectorAll(".department-card");
        departmentCards.forEach(function(card) {
            card.style.display = "none";
        });

        // Hiển thị container nhân viên của phòng ban được chọn
        //   var selectedContainer = document.getElementById(departmentName);
        //   selectedContainer.style.display = "block";

        const employeesContainer = document.getElementById("employeesContainer");
        // Xóa người cũ trước khi thêm mới
        employeesContainer.innerHTML = "";
        fetch(
                `https://api-gateway-test.apecgroup.net/api/cm/apec-event/user-department?department=${departmentName}`
            )
            .then((response) => response.json())
            .then((res) => {
                // Gọi hàm để hiển thị dữ liệu nhân viên
                displayDepartmentData(res.data);
            })
            .catch((error) =>
                console.error("Error fetching department data:", error)
            );
    }

    function doesFileExist(urlToFile) {
        var xhr = new XMLHttpRequest();
        xhr.open("HEAD", urlToFile, false);
        xhr.send();

        if (xhr.status == "404") {
            return false;
        } else {
            return true;
        }
    }

    function displayDepartmentData(res) {
        const randomWishes = [
            "Ngày của phụ nữ, bạn không chỉ là một người phụ nữ, mà còn là nguồn cảm hứng và niềm tự hào của tôi. Chúc mừng ngày 8/3, bạn! Hy vọng bạn sẽ luôn tỏa sáng như một viên ngọc quý trong đám đông, với vẻ đẹp không thể tìm thấy ở bất cứ nơi nào khác.",
            "Ngày hôm nay, tôi muốn gửi tới bạn một lời chúc ấm áp và ý nghĩa nhân ngày phụ nữ. Chúc mừng ngày 8/3, bạn của tôi! Hy vọng bạn sẽ luôn nhận ra rằng bạn là một người phụ nữ đặc biệt, với một trái tim lớn và một tinh thần vững vàng như đá.",
            "Ngày của phụ nữ, bạn không chỉ là một người phụ nữ, mà còn là nguồn cảm hứng và niềm tự hào của tôi. Chúc mừng ngày 8/3, bạn! Hy vọng bạn sẽ luôn tỏa sáng như một viên ngọc quý trong đám đông, với vẻ đẹp không thể tìm thấy ở bất cứ nơi nào khác.",
            "Trong ngày này, tôi muốn dành một lời chúc đặc biệt cho bạn - người phụ nữ mạnh mẽ, độc lập và quyến rũ nhất mà tôi từng gặp. Chúc mừng ngày 8/3, bạn! Hy vọng bạn sẽ luôn giữ được lửa nhiệt và bản lĩnh của mình, và không ngừng đi đến những đỉnh cao mới trong cuộc sống và sự nghiệp.",

            "Ngày hôm nay, tôi muốn gửi tới bạn một lời chúc ấm áp và ý nghĩa nhân ngày phụ nữ. Chúc mừng ngày 8/3, bạn của tôi! Hy vọng bạn sẽ luôn nhận ra rằng bạn là một người phụ nữ đặc biệt, với một trái tim lớn và một tinh thần vững vàng như đá.",

            "Chúc mừng ngày của phụ nữ, bạn của tôi! Bạn là người phụ nữ không chỉ sở hữu vẻ đẹp bên ngoài mà còn có trái tim ấm áp và tình yêu nhân loại. Hy vọng bạn sẽ luôn giữ vững niềm tin vào bản thân và không ngừng lan tỏa tình yêu và sự ấm áp cho mọi người xung quanh.",

            "Trong ngày đặc biệt này, tôi muốn nói rằng bạn là người phụ nữ duy nhất trong tôi trái tim. Chúc mừng ngày 8/3, bạn! Hy vọng bạn sẽ luôn bước đi với đôi chân kiên định trên con đường của mình và không ngừng vươn lên cao hơn.",

            "Ngày hôm nay là một dịp tuyệt vời để tôi gửi đến bạn một lời chúc ấm áp và ý nghĩa. Chúc mừng ngày 8/3, bạn của tôi! Hy vọng bạn sẽ luôn giữ vững niềm tin vào bản thân và không ngừng phấn đấu để trở thành phiên bản tốt nhất của chính mình.",

            "Chúc mừng ngày của phụ nữ, bạn của tôi! Bạn là người phụ nữ duy nhất mà tôi muốn dành trọn trái tim và tâm hồn của mình. Hy vọng bạn sẽ luôn nhận ra giá trị và sức mạnh của mình và không ngừng tỏa sáng như một ngôi sao trên bầu trời đêm.",

            "Trong ngày này, tôi muốn gửi đến bạn một lời chúc ấm áp và ý nghĩa nhất. Chúc mừng ngày 8/3, bạn của tôi! Hy vọng bạn sẽ luôn tự tin và kiên nhẫn trước mọi thử thách, và không ngừng bước đi với niềm tin và hy vọng.",

            "Ngày hôm nay, tôi muốn nói rằng bạn là một phần quan trọng trong cuộc sống của tôi. Chúc mừng ngày 8/3, bạn! Hy vọng bạn sẽ luôn nhận ra rằng bạn xứng đáng nhận được tất cả những điều tốt đẹp nhất trong cuộc sống này.",
            "Chúc mừng ngày của phụ nữ, bạn của tôi! Bạn là người phụ nữ duy nhất mà tôi muốn chia sẻ mọi khoảnh khắc đẹp và khó khăn của cuộc sống. Hy vọng bạn sẽ luôn tự tin và kiên định trên con đường của mình và không ngừng phát triển và trưởng thành.",


            "Ngày của phụ nữ, bạn là nguồn động viên và niềm tự hào của tôi. Chúc mừng ngày 8/3, bạn của tôi! Hy vọng bạn sẽ luôn tỏa sáng như một ngôi sao trong bầu trời đêm, với vẻ đẹp và tâm hồn rạng ngời.",

            "Trong ngày đặc biệt này, tôi muốn gửi đến bạn một lời chúc ý nghĩa và sâu sắc nhất. Chúc mừng ngày 8/3, bạn của tôi! Hy vọng bạn sẽ luôn giữ vững niềm tin và sự kiên định trong mọi tình huống.",

            "Chúc mừng ngày của phụ nữ, bạn của tôi! Bạn là người phụ nữ tuyệt vời nhất mà tôi từng gặp, và tôi luôn tự hào khi có bạn bên cạnh. Hy vọng bạn sẽ luôn tự tin và mạnh mẽ trước mọi thử thách.",

            "Ngày hôm nay, tôi muốn nói rằng bạn là một phần không thể thiếu trong cuộc sống và sự nghiệp của tôi. Chúc mừng ngày 8/3, bạn! Hy vọng bạn sẽ luôn biết ơn và trân trọng bản thân mình, và không ngừng tiến lên phía trước.",

            "Chúc mừng ngày của phụ nữ, bạn của tôi! Bạn là người phụ nữ đặc biệt nhất trong tôi trái tim, và tôi muốn dành lời chúc này để tôn vinh bạn và tình bạn đẹp đẽ mà chúng ta đã chia sẻ. Hy vọng bạn sẽ luôn hạnh phúc và thành công trong mọi điều bạn làm.",

            "Trong ngày này, tôi muốn nói rằng bạn là một phần quan trọng trong cuộc sống của tôi. Chúc mừng ngày 8/3, bạn! Hy vọng bạn sẽ luôn giữ vững niềm tin và sự quyết tâm, và không ngừng phấn đấu để đạt được mọi ước mơ và mục tiêu của mình.",

            "Ngày của phụ nữ, bạn là người phụ nữ duy nhất trong tôi trái tim. Chúc mừng ngày 8/3, bạn của tôi! Hy vọng bạn sẽ luôn nhận ra giá trị và sức mạnh của mình và không ngừng tỏa sáng như một ngôi sao trên bầu trời cuộc đời.",

            "Chúc mừng ngày của phụ nữ, bạn của tôi! Bạn là người phụ nữ đẹp nhất trong tôi mắt, không chỉ về vẻ ngoài mà còn về tâm hồn và tình cảm. Hy vọng bạn sẽ luôn tự tin và kiên định trước mọi thách thức.",

            "Ngày hôm nay, tôi muốn nói rằng bạn là người phụ nữ duy nhất mà tôi muốn dành cả cuộc đời của mình. Chúc mừng ngày 8/3, bạn! Hy vọng bạn sẽ luôn hạnh phúc và thành công trong mọi lĩnh vực của cuộc sống.",

            "Chúc mừng ngày của phụ nữ, bạn của tôi! Bạn là người phụ nữ đặc biệt nhất trong tôi cuộc sống, và tôi rất may mắn khi có bạn bên cạnh. Hy vọng bạn sẽ luôn biết ơn và trân trọng mọi khoảnh khắc đẹp trong cuộc sống của mình.",
        ];
        // Thực hiện các bước để hiển thị dữ liệu
        res.forEach((item) => {
            const useImg = document.createElement("img");
            useImg.className = "img-card";

            const departmentCard = document.createElement("div");
            departmentCard.className = "employee-card";

            const departmentName = document.createElement("div");
            departmentName.className = "employee-name";
            departmentName.textContent = item.name;

            const departmentImage = document.createElement("img");
            departmentImage.className = "employee-image";
            departmentImage.src = doesFileExist(
                    `https://s3.apecgroup.net/apecevent/08_03_APEC/${item.code}.png`
                ) ?
                `https://s3.apecgroup.net/apecevent/08_03_APEC/${item.code}.png` :
                "https://s3.apecgroup.net/apecevent/08_03_APEC/0803default.png";
            departmentImage.alt = "No image";

            // Gắn sự kiện click để hiển thị nhân viên của phòng ban
            departmentCard.onclick = function() {
                const imgContent = document.createElement("img");
                imgContent.src = doesFileExist(
                        `https://s3.apecgroup.net/apecevent/08_03_APEC/${item.code}.png`
                    ) ?
                    `https://s3.apecgroup.net/apecevent/08_03_APEC/${item.code}.png` :
                    "https://s3.apecgroup.net/apecevent/08_03_APEC/0803default.png";

                // Append the imgContent to .wrapper .image-content
                const wrapperImageContent = document.querySelector(
                    ".wrapper .imagecontent"
                );
                wrapperImageContent.innerHTML = "";
                wrapperImageContent.appendChild(imgContent);
                const randomWish =
                    item.code === "APG211001002" ?
                    "My Love ơi, thật may mắn khi mỗi lần căng thẳng, mệt mỏi sau những giờ làm việc, tôi có thể quay sang và nhìn thấy khuôn mặt nhỏ bé của em. Thật tuyệt vời khi mỗi ngày đến công ty lại được nhìn thấy vóc dáng nhỏ bé ấy. Hãy là bông hoa đẹp nhất trong ngày 8/3 này nhé. Thương em!" :
                    item.code === "APG210422003" ?
                    "Nàng thơ à, em không biết trong mắt chúng tôi em xinh đẹp đến nhường nào đâu. Nhân dịp 8/3, bằng cả tấm lòng này, chỉ dám gửi lời chúc qua những dòng thư. Chúc em một ngày thật vui tươi, hồn nhiên và thật hạnh phúc nhé. Cảm ơn em vì đã xinh đẹp 💞💗" :
                    randomWishes[Math.floor(Math.random() * randomWishes.length)];

                //   showEmployees(item.name);
                const wrapperContent = document.querySelector(".wrapper .content h1");
                wrapperContent.textContent = `✉ Gửi, ${item.name}`;

                const loiChuc = document.querySelector(".wrapper .content p");
                loiChuc.textContent = `${randomWish}💗`;

                var btn = document.querySelector("button");
                var closeBtn = document.querySelector(".fa-xmark");

                closeBtn.addEventListener("click", () => {
                    document.querySelector(".wrapper").classList.remove("active");
                    btn.style.display = "block";
                });

                document.querySelector(".wrapper").classList.add("active");
            };

            departmentCard.appendChild(departmentName);
            departmentsContainer.appendChild(departmentCard);
            departmentCard.appendChild(departmentImage);
            // departmentCard.appendChild(imgContent);
        });
    }

    document.addEventListener("DOMContentLoaded", fetchDepartments);

    function goBack() {
        // const wapper = document.querySelectorAll(".wrapper");
        // wapper.forEach(function(card) {
        //     card.style.display = "none";
        // });
        var btn = document.querySelector("button");
        var closeBtn = document.querySelector(".fa-xmark");
        btn.addEventListener("click", () => {
            document.querySelector(".wrapper .active");
            btn.style.display = "none";
        });
        fetchDepartments();
    }

    // function playAudio() {
    //     var audio = document.getElementById("myAudio");
    //     audio.play();
    //     console.log("Audio loaded");
    // }

    // window.addEventListener('load', playAudio)

    // autoAudio();

    // function autoAudio() {

    //     console.log("Page is being refreshed!");

    //     // Attempt to play the audio
    //     try {
    //         var audio = document.getElementById("myAudio");
    //         audio.play();
    //         console.log("Audio played!");
    //     } catch (e) {
    //         console.error("Error playing audio:", e);
    //     }
    //     // window.onbeforeunload = function() {
    //     //     // Your JavaScript code to execute on page refresh (F5) goes here
    //     //     console.log("Page is being refreshed!");

    //     //     // Attempt to play the audio
    //     //     try {
    //     //         var audio = document.getElementById("myAudio");
    //     //         audio.play();
    //     //     } catch (e) {
    //     //         console.error("Error playing audio:", e);
    //     //     }
    //     // };
    // }
</script>

<script>
    var audio = document.getElementById('myAudio');

    function playAudio() {
        audio.play();
    }
</script>

</html>